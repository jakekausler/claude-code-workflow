# STAGE-001-002: Configuration Loader (TDD)

## Status: Complete

## Overview

Create a configuration module that loads Sentry credentials from environment variables with validation and helpful error messages. Built using TDD - write tests first, then implement.

## Reference Implementation

- **Implementation Plan:** [docs/plans/2025-12-09-sentry-explorer-implementation.md:147-307](../../docs/plans/2025-12-09-sentry-explorer-implementation.md) (Task 2)
- **Design Doc - Config:** [docs/plans/2025-12-09-sentry-explorer-design.md:83-87](../../docs/plans/2025-12-09-sentry-explorer-design.md)
- **Design Doc - Environment Variables:** [docs/plans/2025-12-09-sentry-explorer-design.md:139-149](../../docs/plans/2025-12-09-sentry-explorer-design.md)
- **Design Doc - Configuration Errors:** [docs/plans/2025-12-09-sentry-explorer-design.md:207-216](../../docs/plans/2025-12-09-sentry-explorer-design.md)

## Stage Flags

- **Has Input Forms**: [ ] Yes

## Design Phase

- **Interface Design** (from plan):
  ```typescript
  interface SentryConfig {
    authToken: string;
    orgSlug: string;
    projectSlug: string;
    apiUrl: string;
  }
  ```
- **Error Messages**: Include troubleshooting URLs and setup instructions
- **Session Notes**:

**Status**: [x] Complete

## Build Phase

### TDD Workflow

1. **RED Phase** - Write failing test:
   - [x] Create `tests/utils/config.test.ts` with test cases
   - [x] Run `npm test` - verify tests fail

2. **GREEN Phase** - Write minimal implementation:
   - [x] Create `src/utils/config.ts`
   - [x] Implement `loadSentryConfig()` function
   - [x] Implement `ConfigurationError` class
   - [x] Run `npm test` - verify tests pass

3. **REFACTOR Phase** - Clean up:
   - [x] Review error message clarity
   - [x] Ensure code matches design patterns

- **Test Cases Required**:
  - [x] Load config from environment variables
  - [x] Use custom API URL when provided
  - [x] Throw error when auth token missing
  - [x] Throw error when org slug missing
  - [x] Throw error when project slug missing

- **Session Notes**: All phases completed in TDD workflow

**Status**: [x] Complete

## Refinement Phase

- **Verification Checklist**:
  - [x] All 5 test cases pass
  - [x] `npm run type-check` passes
  - [x] Error messages include troubleshooting steps
- **Session Notes**: TDD approach means refinement is built into the process

**Status**: [x] Complete

## Finalize Phase

- [x] Code Review (pre-tests)
- [x] Tests Written and Passing
- [x] Code Review (post-tests)
- [x] Committed with message: `feat(config): add configuration loader with TDD`

**Commit Hash**: 74df300
**CHANGELOG Entry**: N/A (feature not yet user-facing)

**Status**: [x] Complete
